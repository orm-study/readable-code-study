# 5. 객체지향 적용하기

# 상속과 조합

- 상속보다 조합을 사용하자
- 상속은 시멘트처럼 굳어지는 구조다. 수정이 어렵다.
    - 부모와 자식의 결합도가 높다.
        - 결합도: 하나의 객체가 변경이 일어났을 때 다른 객체들이 변경이 일어난 정도
- 조합과 인터페이스를 활용하는 것이 유연한 구조
    - 상속을 통한 코드의 중복 제거가 주는 이점보다, 중복이 생기더라도 유연한 구조 설계가 주는 이점이 더 크다.

부모의 공통기능을 별도의 객체로 두고, 각 자식 클래스에서 공통기능 객체를 가져다가 사용하면 되는 것이 조합으로 상속을 풀어내는 방식.

확실한 상속구조가 아니면 조합을 사용하자.

(정말 변경이 제한적일 것 같고 상속으로 인한 이점이 클 것 같은 경우만 상속을 사용)

# Value Object

- 도메인의 어떤 개념을 추상화하여 표현한 값 객체
- 값으로 취급하기 위해서, 불변성, 동등성, 유효성 검증 등을 보장해야 한다.
    - 불변성: final 필드, setter 금지
    - 동등성: 서로 다른 인스턴스여도(동일성이 달라도), 내부의 값이 같으면 같은 값 객체로 취급한다. equals() & hashCode() 재정의 필요.
    - 유효성 검증: 객체가 생성되는 시점에 값에 대한 유효성을 보장하기.

이 클래스를 기본 타입들(int, long …)처럼 쓸거야. 라는 의미

## VO vs. Entity

- Entity는 식별자가 존재한다. 식별자가 아닌 필드의 값이 달라도, 식별자가 같으면 동등한 객체로 취급한다.
    - 식별자가 같은데 식별자가 아닌 필드의 값이 서로 다른 두 인스턴스가 있다면, 같은 Entity가 시간이 지남에 따라 변화한 것으로 이해할 수도 있다.
- VO는 식별자 없이, 내부의 모든 값이 다 같아야 동등한 객체로 취급한다.
    - 개념적으로, 전체 필드가 다같이 식별자 역할을 한다고 생각해도 된다.

```java
gameBoard.flag(rowIndex, colIndex);
//vo 사용
gameBoard.flag(cellPosition);
//코드가 더 매끄럽게 읽히도록 전치사 추가
gameBoard.flagAt(callPosition);

cellPosition.caculatePositionBy(relativePosition);
```

vo를 사용함으로써 불변성, 동등성, 유효성 검증의 이점을 얻을 수 있다.

vo 내부에 책임을 위임함으로써 조금 더 의미가 명확한 코드를 만들 수 있다.

# 일급컬렉션

## 일급 시민

- 다른 요소에게 사용 가능한 모든 연산을 지원하는 요소
    - 변수로 할당될 수 있다.
    - 파라미터로 전달될 수 있다.
    - 함수의 결과로 반환될 수 있다.
    - ex) 일급 함수
        - 함수형 프로그래밍 언어에서, 함수는 일급 시민이다. 함수는 변수에 할당될 수 있고, 인자로 전달될 수 있고, 함수의 결과로 함수가 반환될 수도 있다.
- 컬렉션을 포장하면서, 컬렉션만을 유일하게 필드로 가지는 객체
    - 컬렉션을 다른 객체와 동등한 레벨로 다루기 위함
    - 단 하나의 컬렉션 필드만을 가진다.
- 컬렉션을 추상화하며 의미를 담을 수 있고, 가공 로직의 보금자리가 생긴다.
    - 가공 로직에 대한 테스트도 작성할 수 있다.(public, private)
- 만약 getter로 컬렉션을 반환할 일이 생긴다면, 외부 조작을 피하기 위해 꼭 새로운 컬렉션으로 만들어서 반환해주자.

```java
class CreditCards {
	private final List<CreditCard> cards;
	
	//생성자
	
	public List<CreditCard> findValidCards() {
		return this.cards.stream()
			.filter(CreditCard::isValid)
			.toList();
	}
	
	//외부에서 리스트를 변경할 수 없도록 새로운 리스트를 만들어서 반환해주어야 한다.
	// return new ArrayList<>(positions);
}
```

목록을 가공하는 것에 대한 책임이 일급 컬렉션으로 넘어간다.

Cells가 cell list, collection 가공에 대한 책임을 가져가게 됨.

+재활용성
